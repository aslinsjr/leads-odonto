<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador de Dados - Dentistas</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Visualizador de Dados - Dentistas e Cl√≠nicas</h1>
            <p>Dados extra√≠dos do Instagram</p>
        </div>

        <div class="controls">
            <input type="text" class="search-box" id="searchInput" placeholder="üîç Pesquisar por qualquer campo...">
            
            <div class="export-buttons">
                <button id="exportExcel" class="export-btn excel">
                    üìó Excel
                </button>
                <button id="exportCSV" class="export-btn csv">
                    üìÑ CSV
                </button>
                <select id="exportOptions" class="export-select">
                    <option value="all">Todos os dados</option>
                    <option value="filtered">Dados filtrados</option>
                    <option value="visible">Colunas vis√≠veis</option>
                </select>
            </div>

            <button id="toggleColumns" class="control-btn">
                ‚öôÔ∏è Colunas
            </button>
            
            <button id="toggleFilters" class="control-btn">
                üîΩ Filtros
            </button>
            
            <button id="clearFilters" class="control-btn clear" style="display: none;">
                ‚úñ Limpar Filtros
            </button>
        </div>

        <div id="columnMenu" class="dropdown-menu" style="display: none;">
            <div class="menu-header">Exibir/Ocultar Colunas</div>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="0" checked> ID Instagram
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="1" checked> Conta
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="2" checked> Nome
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="3" checked> Bio
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="4" checked> Telefone
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="5" checked> E-mail
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="6" checked> Link Bio
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="7" checked> Local
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="8" checked> Idioma
            </label>
            <label class="menu-item">
                <input type="checkbox" class="column-toggle" data-column="9" checked> Especialidades
            </label>
        </div>

        <div class="stats" id="stats">
            Carregando dados...
        </div>

        <div id="filterRow" class="filter-row" style="display: none;">
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="ID_Insta" placeholder="Filtrar...">
            </div>
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="Conta_Insta" placeholder="Filtrar...">
            </div>
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="Nome" placeholder="Filtrar...">
            </div>
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="Bio" placeholder="Filtrar...">
            </div>
            <div class="filter-cell">
                <select class="filter-select" data-column="Telefone">
                    <option value="">Todos</option>
                    <option value="has">Com telefone</option>
                    <option value="empty">Sem telefone</option>
                </select>
            </div>
            <div class="filter-cell">
                <select class="filter-select" data-column="e-mail">
                    <option value="">Todos</option>
                    <option value="has">Com e-mail</option>
                    <option value="empty">Sem e-mail</option>
                </select>
            </div>
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="Link-Bio" placeholder="Filtrar...">
            </div>
            <div class="filter-cell">
                <select class="filter-select" data-column="Local" multiple>
                    <option value="">Carregando...</option>
                </select>
            </div>
            <div class="filter-cell">
                <select class="filter-select" data-column="Idioma" multiple>
                    <option value="">Carregando...</option>
                </select>
            </div>
            <div class="filter-cell">
                <input type="text" class="filter-input" data-column="Especialidades_Extraidas" placeholder="Filtrar...">
            </div>
        </div>

        <div class="controls pagination-controls">
            <div id="pageInfo">
                P√°gina 1
            </div>
            <div class="pagination-center">
                <button id="firstPage" class="page-btn">¬´</button>
                <button id="prevPage" class="page-btn">‚Äπ</button>
                <input type="number" id="pageInput" class="page-input" value="1" min="1">
                <span id="totalPages" class="total-pages">/ 1</span>
                <button id="nextPage" class="page-btn">‚Ä∫</button>
                <button id="lastPage" class="page-btn">¬ª</button>
            </div>
            <div>
                <select id="pageSizeSelect" class="page-size-select">
                    <option value="25">25 por p√°gina</option>
                    <option value="50" selected>50 por p√°gina</option>
                    <option value="100">100 por p√°gina</option>
                    <option value="250">250 por p√°gina</option>
                    <option value="500">500 por p√°gina</option>
                    <option value="1000">1000 por p√°gina</option>
                </select>
            </div>
        </div>

        <div class="table-wrapper">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th class="sortable" data-column="ID_Insta">
                            ID Instagram
                            <span class="filter-indicator" data-column="ID_Insta" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Conta_Insta">
                            Conta
                            <span class="filter-indicator" data-column="Conta_Insta" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Nome">
                            Nome
                            <span class="filter-indicator" data-column="Nome" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Bio">
                            Bio
                            <span class="filter-indicator" data-column="Bio" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Telefone">
                            Telefone
                            <span class="filter-indicator" data-column="Telefone" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="e-mail">
                            E-mail
                            <span class="filter-indicator" data-column="e-mail" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Link-Bio">
                            Link Bio
                            <span class="filter-indicator" data-column="Link-Bio" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Local">
                            Local
                            <span class="filter-indicator" data-column="Local" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Idioma">
                            Idioma
                            <span class="filter-indicator" data-column="Idioma" style="display: none;">üîç</span>
                        </th>
                        <th class="sortable" data-column="Especialidades_Extraidas">
                            Especialidades
                            <span class="filter-indicator" data-column="Especialidades_Extraidas" style="display: none;">üîç</span>
                        </th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="10" class="no-data">Carregando...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="loadingOverlay" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <div class="loading-text">Processando <span id="loadingCount">0</span> registros...</div>
                <div class="loading-progress">
                    <div id="loadingBar" class="loading-bar"></div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>